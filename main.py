from vulnerability_scanners import scan_url, click_jack, scan_idor, scan_xss, custom_payloads

def main():
    website = input("Enter the URL to scan for vulnerabilities: ")
    print("Running Scan.....")
    # Check for xss injection vulnerabilities
    xss_results = scan_xss(website)

    if "No XSS vulnerability found" in xss_results:
        print(".....No XSS vulnerability found")
    else:
        for result in xss_results:
            print(result)


    # Check for SQL injection vulnerabilities
    sql_injection_vulnerable_urls = scan_url(website)
    
    

    if sql_injection_vulnerable_urls:
        print(".....SQL injection vulnerabilities found.")
        for url in sql_injection_vulnerable_urls:
            print(url)
    else:
        print(".....No SQL injection vulnerabilities found.")
    
    # Check for clickjacking vulnerabilities
    is_clickjacking_vulnerable = click_jack(website)
    if is_clickjacking_vulnerable:
        print(".....Clickjacking vulnerability found.")
    else:
        print(".....No Clickjacking vulnerability found.")

    user_input = input("Enter the user input to test for IDOR: ")
    idor_result = scan_idor(website, user_input)

    if idor_result:
        print(".....IDOR vulnerability found.")
        print(idor_result)
    else:
        print(".....No IDOR vulnerabilities found.")

if __name__ == "__main__":
    main()

